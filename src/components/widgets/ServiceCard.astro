---
import type { ServiceCardData } from "../../types/types";

interface Props {
    service: ServiceCardData;
    index?: number;
    linkText?: string;
}

const { service, index = 1, linkText = "DÃ©couvrir" } = Astro.props;
const displayIndex = String(service.index ?? index).padStart(2, "0");
---

<a
    href={service.href}
    class="group relative block aspect-[3/4] md:aspect-[4/5] bg-card border border-border/50 rounded-3xl overflow-hidden transition-all duration-500 hover:border-primary/30 hover:shadow-[var(--shadow-gold-card)] hover:-translate-y-2"
>
    {/* Gold bar top - expands on hover */}
    <div class="absolute top-0 left-0 h-[3px] w-1/4 bg-gradient-to-r from-primary to-primary-light transition-all duration-500 group-hover:w-full z-10"></div>

    {/* Number above image */}
    <span class="absolute top-4 right-5 text-7xl font-extrabold text-white/[0.08] leading-none select-none pointer-events-none z-20" aria-hidden="true">
        {displayIndex}
    </span>

    {/* Image or pattern area */}
    <div class="absolute inset-0 overflow-hidden">
        {
            service.image ? (
                typeof service.image === "string" ? (
                    <img
                        src={service.image}
                        alt={service.title}
                        class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                    />
                ) : (
                    <img
                        src={service.image.src}
                        alt={service.title}
                        class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                    />
                )
            ) : (
                <div class="w-full h-full">
                    <svg class="w-full h-full opacity-[0.04]" aria-hidden="true">
                        <pattern id={`pattern-${displayIndex}`} x="0" y="0" width="30" height="30" patternUnits="userSpaceOnUse">
                            <circle cx="15" cy="15" r="1" fill="currentColor" class="text-primary" />
                            <line x1="0" y1="15" x2="30" y2="15" stroke="currentColor" class="text-primary" stroke-width="0.3" />
                            <line x1="15" y1="0" x2="15" y2="30" stroke="currentColor" class="text-primary" stroke-width="0.3" />
                        </pattern>
                        <rect width="100%" height="100%" fill={`url(#pattern-${displayIndex})`} />
                    </svg>
                </div>
            )
        }
    </div>

    {/* Gradient overlay */}
    <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>

    {/* Content */}
    <div class="absolute bottom-0 left-0 right-0 p-6 z-10">
        <h3 class="text-xl font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300">
            {service.title}
        </h3>
        <p class="text-sm text-foreground/70 leading-relaxed mb-4 line-clamp-3">
            {service.description}
        </p>
        <span class="inline-flex items-center text-sm font-medium text-primary">
            {linkText}
            <svg class="w-4 h-4 ml-1 transition-transform duration-300 group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
        </span>
    </div>
</a>
